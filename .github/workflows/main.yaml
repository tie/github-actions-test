name: Main
on: push

jobs:
  win32:
    runs-on: windows-latest
    steps:
      - name: Variables
        id: vars
        run: |
          echo "::group::sdk"
          cd $HOME && mkdir sdk && cd sdk
          echo "::set-output name=sdk::$PWD"
          echo "::endgroup::"
          echo "::group::tip"
          echo "::set-output name=tip::$(
            curl -f -s -L "$gotip" | awk '/"commit"/{print substr($2,2,40);exit}'
          )"
          echo "::endgroup::"
        env:
          gotip: 'https://go.googlesource.com/go/+/refs/heads/master?format=JSON'

      - name: Print
        run: |
          echo ${{ steps.vars.outputs.tip }}
          echo ${{ steps.vars.outputs.sdk }}
  main:
    runs-on: ubuntu-latest
    steps:
      - uses: tie/github-actions-test@master
        with:
          name: world
      - run: |
          echo Running on ${{ runner.os }}
